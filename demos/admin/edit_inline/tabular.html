{% load i18n %}
<div class="inline-group">
  <div class="tabular inline-related {% if forloop.last %}last-related{% endif %}">
{{ inline_admin_formset.formset.management_form }}
<script src="/media/swfupload/js/jquery-1.3.2.min.js" type="text/javascript"></script>
<script src="/media/swfupload/js/jquery-ui-1.7.1.custom.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
	$("#sortable").sortable({
		placeholder: 'placeholder',
		stop: function() {
			order = new Array();
			d = new Date();
			dstr = d.getFullYear()+'-'+(d.getMonth()+1)+'-'+d.getDate()+' '+d.getHours()+':'+d.getMinutes()+':'+d.getSeconds()+'.'
			$("#sortable li").each(function(n, item) {
				order[n] = item.id*100000;
			});
			order.reverse();
			N = order.length;
			for (k=0; k < N; ++k)
				document.forms[0].elements['image_set-'+k+'-cdate'].value = dstr + order[k];
		}
	});
	$("#sortable").disableSelection();
});
</script>
<style>
.placeholder { border: 2px dotted; height: 80px; background: #acf; }
</style>
<fieldset class="module">
	<h2>{{ inline_admin_formset.opts.verbose_name_plural|capfirst }}</h2>
	{{ inline_admin_formset.formset.non_form_errors }}
	<ul id="sortable" style="list-style-type: none; padding: 0">
	{% for inline_admin_form in inline_admin_formset %}
		{% if inline_admin_form.form.non_field_errors %}
			<li>{{ inline_admin_form.form.non_field_errors }}</li>
		{% endif %}
		<li id="{{ forloop.counter0 }}" class="{% cycle row1,row1 %}">
		 
			{% if inline_admin_form.original or inline_admin_form.show_url %}
			<!-- {{ inline_admin_form.original }} -->
			{% endif %}
			{{ inline_admin_form.pk_field.field }} {{ inline_admin_form.fk_field.field }}
		 
			<table><tr><td>{{ forloop.counter0 }}</td>
			{% for fieldset in inline_admin_form %}
				{% for line in fieldset %}
					{% for field in line %}
						{% if field.is_hidden %}
							{{ field.field }}
						{% else %}
						<td class="{{ field.field.name }}">
						{{ field.field }}
						{{ field.field.errors.as_p }}
						</td>
						{% endif %}
					{% endfor %}
				{% endfor %}
			{% endfor %}
			{% if inline_admin_formset.formset.can_delete %}
				<td class="delete">{% if inline_admin_form.original %}{{ inline_admin_form.deletion_field.field }}{% endif %}</td>
			{% endif %}
			</tr></table>
		
		</li>
	{% endfor %}
	</ul>
</fieldset>
</div>
</div>